z{% extends 'blog/base.html' %}

{% block content %}
<div class="profile-header">
    {% if user.profile.avatar %}
        <img src="{{ user.profile.avatar.url }}" alt="–ê–≤–∞—Ç–∞—Ä" width="100" height="100" style="border-radius: 50%;">
    {% else %}
        <div style="width: 100px; height: 100px; background: #ccc; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
            –ù–µ—Ç –∞–≤–∞—Ç–∞—Ä–∞
        </div>
    {% endif %}
    <h1>{{ user.username }}</h1>
    <p>{{ user.profile.bio|default:"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–∏–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ" }}</p>
    <div>
        <a href="{% url 'edit_profile' %}" style="background: #007bff; color: white; padding: 8px 15px; text-decoration: none; border-radius: 4px;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</a>
        <a href="{% url 'delete_profile' %}" style="background: #dc3545; color: white; padding: 8px 15px; text-decoration: none; border-radius: 4px; margin-left: 10px;">–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</a>
    </div>
</div>

<h2>–ú–æ–∏ –ø–æ—Å—Ç—ã</h2>

{% for post in page_obj %}
    <div class="post">
        <div class="post-header">
            <strong>{{ post.author.username }}</strong>
            <small>{{ post.created_at }}</small>
            <div class="post-actions">
                <a href="{% url 'edit_post' post.id %}" style="color: #007bff;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                <form method="post" action="{% url 'delete_post' post.id %}" style="display: inline;">
                    {% csrf_token %}
                    <button type="submit" style="color: #dc3545; border: none; background: none; cursor: pointer;">–£–¥–∞–ª–∏—Ç—å</button>
                </form>
            </div>
        </div>
        <p>{{ post.content }}</p>

        <div class="post-stats">
            <span>‚ù§Ô∏è {{ post.like_set.count }}</span>
            <span>üí¨ {{ post.comment_set.count }}</span>
        </div>

        <div class="comment-section">
            <form method="post" action="{% url 'add_comment' post.id %}">
                {% csrf_token %}
                {{ comment_form.content }}
                <button type="submit">–ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            </form>

            {% for comment in post.comment_set.all %}
                <div class="comment">
                    <strong>{{ comment.user.username }}:</strong>
                    {{ comment.content }}
                    <small>{{ comment.created_at }}</small>
                </div>
            {% endfor %}
        </div>
    </div>
{% empty %}
    <p>–£ –≤–∞—Å –µ—â–µ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤. <a href="{% url 'create_post' %}">–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç!</a></p>
{% endfor %}

<div class="pagination">
    {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}">–ù–∞–∑–∞–¥</a>
    {% endif %}

    <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page_obj.number }} –∏–∑ {{ page_obj.paginator.num_pages }}</span>

    {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}">–í–ø–µ—Ä–µ–¥</a>
    {% endif %}
</div>
{% endblock %}